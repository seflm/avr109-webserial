<!doctype html>
<html>

<head>
	<title>QVEX Flasher</title>
	<link rel="stylesheet" href="css/style.css" />
</head>

<body>
    <input id="fileInput" tabindex="-1" type="file" /><br>
    <button id="readyButton" disabled>I'm ready</button>


    <script src="js/flasher.js"></script>
    <script>

        const readyButtonElement = document.getElementById("readyButton");
        const fileInputElement = document.getElementById('fileInput');


        readyButtonElement.addEventListener("click",(e)=>
        {
            console.log("ready");

            const file = fileInput.files[0];
            const fileReader = new FileReader();

            fileReader.onload = async function (event) 
			{
                console.log("file onload");
                const flasher = new AVR109Flasher(event.target.result,0x2341,0x0036);
                flasher.flash();
            }

            fileReader.readAsText(file);

            
        });

        fileInputElement.addEventListener('change', (event) => 
		{
			/* const file = event.target.files[0];
			if (file)
				fileName.textContent = file.name; */
            if (event.target.files[0])
            {
                readyButtonElement.disabled = false;
            }
		});

    </script>

    
</body>
</html>